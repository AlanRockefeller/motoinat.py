# iNaturalist Observation Finder

This script allows you to find iNaturalist observations that correspond to specific Mushroom Observer (MO) observation numbers. It supports retrieving data from a list of numbers or from a file and offers multiple output options, including URLs or observation IDs only.

By Alan Rockefeller - May 15, 2025

## Version 1.1
- Supports https or http MO URL's
- Supports the new mushroomobserver.org/obs/ URL's

## Features
- Search for iNaturalist observations based on Mushroom Observer numbers.
- Support for inputting observation numbers directly or via a file.
- Output options:
  - Full details of the matched observation (species, location, etc.).
  - iNaturalist observation URL only.
  - iNaturalist observation number only.
- Debug mode (`--debug`) for detailed logging of operations, including API request/response information.
- Robust error handling for network issues, API response errors, and file I/O problems.
- Input validation: Invalid (non-numeric) Mushroom Observer numbers are reported via stderr and skipped.

## How the Script Works
The script performs the following steps to find a corresponding iNaturalist observation for a given Mushroom Observer number:

1. **Constructing URLs:**
   The script generates potential Mushroom Observer URLs using the provided observation number. For example:
   - `http://mushroomobserver.org/observer/show_observation/{mo_number}`
   - `https://mushroomobserver.org/{mo_number}`

2. **Making API Requests:**
   These URLs are used as query parameters in requests to the iNaturalist API. Specifically, the script searches for observations on iNaturalist where the "Mushroom Observer URL" field matches the generated URLs.

3. **Evaluating Responses:**
   - If the iNaturalist API finds one or more matching observations, the script extracts the details of the first match. 
   - Details include the iNaturalist observation ID, URL, species guess, and location.
   - If no matches are found, the script reports that no corresponding iNaturalist observation exists for the given Mushroom Observer number.

### Detection Conditions
For the script to detect a corresponding iNaturalist observation:
- The iNaturalist observation must have a custom field named "Mushroom Observer URL."
- The value of this field must exactly match one of the URLs generated by the script for the given Mushroom Observer number.

If these conditions are not met, the script will not detect a corresponding observation.

## Requirements
- Python 3.6 or higher
- The following Python libraries:
  - `requests` (external dependency)
  - `argparse` (standard library)
  - `json` (standard library)
  - `logging` (standard library)

## Installation
Clone or download this repository. The primary external dependency is `requests`.
Install it using pip:
```bash
pip install requests
```
The other libraries (`argparse`, `json`, `logging`) are part of the Python standard library and do not need separate installation.

## Usage
Run the script `motoinat.py` with the desired Mushroom Observer numbers or specify a file containing observation numbers.

### Command-Line Arguments
| Argument         | Description                                                                 |
|------------------|-----------------------------------------------------------------------------|
| `mo_numbers`     | One or more numeric Mushroom Observer numbers.                            |
| `--file FILE`    | File containing numeric Mushroom Observer numbers, separated by spaces or newlines. Invalid/empty lines are skipped. |
| `--debug`        | Enable verbose debug logging, including detailed API request/response information. |
| `--url`          | Output only the iNaturalist observation URL.                              |
| `-q`             | Output only the iNaturalist observation number.                          |

### Examples
#### Search Using Observation Numbers
```bash
python motoinat.py 12345 
```

#### Search Using a File
```bash
python motoinat.py --file observations.txt
```

#### Output URLs Only
```bash
python motoinat.py 12345 67890 --url
```

#### Output Observation Numbers Only
```bash
python motoinat.py 12345 67890 -q
```

#### Enable Debug Mode
```bash
python motoinat.py 12345 67890 --debug
```

## License
This program is licensed under the GNU GPL 3.0 License - see the LICENSE.md file for details.

## Contact
For questions or suggestions, please contact Alan Rockefeller via my name at gmail, Instagram, Linkedin or Facebook messenger.

